\documentclass{article}
\usepackage{spikey}
\usepackage{amsmath}
\usepackage{mathrsfs}
\usepackage{amssymb}
\usepackage{soul}
\usepackage{float}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{fancyhdr}
\usepackage{xcolor}
\usepackage{chngcntr}
\usepackage{centernot}
\usepackage[shortlabels]{enumitem}
\usepackage[margin=1truein]{geometry}
\usepackage{tkz-graph}
\usepackage{dsfont}
\usepackage{caption}
\usepackage{subcaption}

\usepackage{setspace}
\linespread{1.15}
\usepackage[margin=1truein]{geometry}

\counterwithin{equation}{section}
\counterwithin{figure}{section}

\title{ECO426H1 Market Design: Auctions and Matching Markets}
\author{Tianyu Du}
\date{\today}

\begin{document}
	\maketitle
	\tableofcontents
	
	\newpage
	
	\section{Auctions}
	\begin{definition}
		An \textbf{auction} is an \ul{informational environment} consisting of
		\begin{enumerate}[(i)]
			\item \textbf{Bidding format rules}: the form of the bids, which can be price only, multi-attribute, price and quantity, or quantity only;
			\item \textbf{Bidding process rules}: Closing/timing rules, available information, rules for bid improvements/counter-bids, closing conditions;
			\item \textbf{Price and allocation rules}: final prices, quantities, winners.
		\end{enumerate}
		Auctions are commonly referred to as a \ul{market mechanism} as well as a \ul{price discovery mechanism}
	\end{definition}
	
	\begin{definition}
		A \textbf{market mechanism} uses prices to determine allocations.
	\end{definition}

	\begin{definition}
		An auction is a \textbf{private value} auction if agents' valuations do not dependent on other buyers' valuations. Otherwise, the auction is called a \textbf{interdependent / common value} auction.
	\end{definition}
	
	\subsection{Private Value Auctions}
	
	\begin{assumption}
		In this chapter, we shall impose the following assumption on bidders' valuations:
		\begin{enumerate}[(i)]
			\item Each bidder's valuation is independently and identically distributed on some interval $[0, \omega]$ according to a distribution function $F$:
			\begin{align}
				V_i \overset{i.i.d.}{\sim} F\ s.t.\ \tx{supp}(F) = \R_+
			\end{align}
			\item $F$ belongs to the common knowledge in this system;
			\item Bidders' valuations have finite expectations:
			\begin{align}
				\expect{V_i} < \infty
			\end{align}
		\end{enumerate}
	\end{assumption}
	
	\begin{assumption}
		Moreover, we assume bidders' behaviours to satisfy the following properties:
		\begin{enumerate}[(i)]
			\item Bidders are risk neutral, they are maximizing expected profits;
			\item Each bidder it both willing and able to pay up to his or her value.
		\end{enumerate}
	\end{assumption}
	
	\begin{definition}
		A \textbf{strategy} of a bidder is a mapping from the space of his/her valuation to a bid:
		\begin{align}
			s: [0, \omega] \to \R_+
		\end{align}
	\end{definition}
	
	\begin{definition}
		An equilibrium of auction is \textbf{symmetric} if all bidders are following the same bidding strategy $s$.
	\end{definition}
	
	\begin{definition}
		A bidder is \textbf{bidding sincerely / truthfully} if he bids his true value. 
	\end{definition}
	
	\begin{proposition}
		In a symmetric equilibrium of the \ul{second-price} auction, $s(v) = v$ is a weakly dominant strategy.
	\end{proposition}
	
	\begin{proof}
		For a fixed valuation $v_i \in [0, \omega]$ of bidder $i$. \\
		Let $p := \max_{j \neq i} b_j$ be highest bidding price by other bidders. \\
		Let $\pi_i(b, p)$ denote bidder $i$'s profit when bidding $b$ given the highest price from other bidders to be $p$. \\
		\textbf{Part 1:} consider another bidding $z_i < v_i$, the following cases are possible: 
		\begin{enumerate}[(i)]
			\item $v_i < p \implies z_i < v_i < p \implies \pi_i(v_i, p) = \pi_i(z_i, p) = 0$ (bidder $i$ losses anyway).
			\item $v_i = p \implies \pi_i(v_i, p) = \pi_i(z_i, p) = 0$ (bidder $i$ is indifferent).
			\item $v_i > p$:
			\begin{enumerate}
				\item $v_i > z_i > p \implies \pi_i(v_i, p) = \pi_i(z_i, p) = v_i - p$;
				\item $v_i > z_i = p \implies \pi_i(v_i, p) \geq \pi_i(z_i, p)$;
				\item $v_i > p > z_i \implies \pi_i(v_i, p) > \pi_i(z_i, p)$.
			\end{enumerate}
		\end{enumerate}
		Hence, bidding $v_i$ weakly dominates bidding any value below it. \\
		\textbf{Part 2}: for $z_i > v_i$, the following cases are possible:
		\begin{enumerate}[(i)]
			\item \todo{d}
		\end{enumerate}
		Therefore, bidding $v_i$ weakly dominates bidding any other values.
	\end{proof}
	
	\begin{proposition}
		In a symmetric equilibrium of the \ul{first-price} auction, equilibrium bidding strategies are given by
		\begin{align}
			s(v_i) = \expect{\max_{j \neq i} v_j | v_j \leq v_i}
		\end{align}
		which is the \emph{expected second highest valuation conditional on $v_i$ being the highest valuation.}
	\end{proposition}
	
	\begin{proof}
		Let $s(v)$ denote an equilibrium strategy.
		\begin{lemma}
			For any agent, bidding more than $s(\omega)$ can never be optimal. Bidding $b > s(\omega)$ makes this agent win for sure. In such case, bidding $b' \in (s(\omega), b)$ strictly dominates bidding $b$.
		\end{lemma}
		\begin{lemma}
			For any agent, $s(0) = 0$. Bidding any positive number would cause negative payoff with positive probability, and therefore, leads to a negative expected profit.
		\end{lemma}
		\begin{lemma}
			Because $s$ is monotonically increasing, therefore,
			\begin{align}
				\max_{j \neq i} s(v_j) = s(\max_{j \neq i} v_j)
			\end{align}
		\end{lemma}
		Let $p$ denote the highest price among all other $N-1$ bidders and let $F^{(N-1)}(x)$ denote the distribution of $p$. \\
		The expected profit of bidder $i$ by bidding an arbitrary $b \in \R_+$ is
		\begin{align}
			\pi_i(b, v_i) &= P(b > p) (v_i - s(v_i))
			+ P(b = p) (v_i - s(v_i))
			+ P(b < p) 0
		\end{align}
		Note that $b > p = s(\max_{j \neq i}v_j)$ if and only if $s^{-1}(b) > \max_{j \neq i}v_j$. It follows
		\begin{align}
			P(b > p) = P(\max_{j \neq i}v_j < s^{-1}(b)) = F^{(N-1)}(s^{-1}(b))
		\end{align}
		Therefore,
		\begin{align}
			\pi_i(b, v_i) = F^{(N-1)}(s^{-1}(b)) (v_i - b)
		\end{align}
		The first order condition implies
		\begin{align}
			\pd{\pi_i}{b} \pi_i (b, v_i) 
			&= \pd{\pi_i}{b} F^{N-1} (s^{-1}(b)) v_i - F^{N-1} (s^{-1}(b)) b \\
			&= f^{(N-1)}(s^{-1}(b)) \frac{v_i - b}{s'(v_i)}
			- F^{(N-1)}(s^{-1}(b)) = 0
		\end{align}
		For a symmetric equilibrium, all other bidders are following the same strategy $s$ so that $s(v_i) = b$, therefore, 
		\begin{align}
			f^{(N-1)}(s^{-1}(b)) \frac{v_i - b}{s'(v_i)}
			- F^{(N-1)}(s^{-1}(b)) = 0 \\
			\implies f^{(N-1)}(s^{-1}(b)) (v_i - b)
			- F^{(N-1)}(s^{-1}(b)) s'(v_i) = 0 \\
			\implies f^{(N-1)}(s^{-1}(b)) v_i = F^{(N-1)}(s^{-1}(b)) s'(v_i) + f^{(N-1)}(s^{-1}(b)) s(v_i) \\
			\implies f^{(N-1)}(v_i) v_i = \frac{d}{dv_i} \left[ F^{(N-1)}(v_i) s(v_i) \right] \\
			\implies \int_{0}^{v_i} f^{(N-1)}(y) y\ dy = F^{(N-1)}(v_i) s(v_i) - F^{(N-1)}(0) s(0) \\
			\implies F^{(N-1)}(v_i) s(v_i) = \int_{0}^{v_i} f^{(N-1)}(y) y\ dy \\
			\implies s(v_i) = \frac{1}{F^{(N-1)}(v_i)} \int_{0}^{v_i} f^{(N-1)}(y) y\ dy \\
			\implies s(v_i) = \expe \left[\max_{j \neq i} v_j \right|\left. \max_{j \neq i} v_j < v_i \right]
		\end{align}
	\end{proof}
	
	\section{First Price Private Value Auction}
	\begin{remark}
		For every continuous distribution $F$, the probability for a tie to happen is zero. Therefore, we ignore the tie for now.
	\end{remark}
	
	\paragraph{Problem Setup} Let $N$ denote the set of bidders such that $|N| = n$. For each bidder $i \in N$, his valuation of the auctioned item $V_i$ follows some distribution $F$. Further assume that $V_i \perp V_j$ for every $i \neq j$. \\
	Let $W(b, v_i)$ denote the event that player $i$, who has valuation $v_i$, wins by bidding $b \in \R_+$, define 
	\begin{align}
		W(b, v_i) \iff b > \max_{j \neq i} b_j
	\end{align}
	The payoff (utility) of bidder $i$, who has valuation $v_i$, is
	\begin{align}
		U(b, v_i) = \begin{cases}
			v_i - b &\tx{ if } W(b, v_i) \\
			0 &\tx{ otherwise}
		\end{cases}
	\end{align}
	
	\subsection{Symmetric Equilibrium Behaviour}
	\par Consider a symmetric environment such that all bidders are using the same \ul{strictly increasing} strategy $s(\cdot)$ such that $s(\cdot)$ is invertible.
	\paragraph{Equilibrium Strategy} when $F = Unif(0, 1)$.
	\begin{align}
		\beta^I(v) = \frac{n-1}{n} v
	\end{align}
	
	\paragraph{Probability of Winning}
	\begin{align}
		P(W(b, v_i))
		&= P(b > \max_{j \neq i} s(v_j)) \\
		&= P(b > s(\max_{j \neq i} v_j)) \\
		&= P(\max_{j \neq i} v_j \leq s^{-1}(b))) \\
		&= F(s^{-1}(b))^{n-1} \\
		&= F(v_i)^{n-1} \tx{ because } b = s(v_i)
	\end{align}
	When $F = Unif(0, 1)$,
	\begin{align}
		P(W(b, v_i)) &= v_i^{n-1}
	\end{align} 
	
	\paragraph{Expected Payment from Bidder $i$ with $v_i$ Conditioned on Winning} Suppose bidder $i$ is following strategy $s(\cdot)$. Then,
	\begin{align}
		\expect{Payment_i|v_i, W(b, v_i)} = b = s(v_i)
	\end{align}
	When $F = Unif(0, 1)$,
	\begin{align}
		\expect{Payment_i|v_i, W(b, v_i)} = \frac{n-1}{n} v_i
	\end{align}
	
	\paragraph{Unconditional Payment from Bidder $i$ with $v_i$}
	\begin{align}
		\expect{Payment_i|v_i} &= P(W(b, v_i)) \expect{Payment_i|v_i, W(b, v_i)} + P(Loss) \times 0 \\
		&= P(W(b, v_i)) \expect{Payment_i|v_i, W(b, v_i)} \\
		&= F(v_i)^{n-1} s(v_i)
	\end{align}
	When $F = Unif(0, 1)$,
	\begin{align}
		\expect{Payment_i|v_i} &= \frac{n-1}{n}v_i^n
	\end{align}

	\paragraph{Expected Payoff of Bidder $i$ with $v_i$}
	\begin{align}
		\expect{U|v_i}
		&= P(W(s(v_i), v_i)) v_i - \expect{Payment_i|v_i} \\
		&= F(v_i)^{n-1} v_i - F(v_i)^{n-1}s(v_i) \\
		&= F(v_i)^{n-1} [v_i - s(v_i)]
	\end{align}
	When $F = Unif(0, 1)$,
	\begin{align}
		\expect{U|v_i} = \frac{v_i^n}{n}
	\end{align}
	
	\paragraph{Unconditional Payment from Bidder $i$} This is the same as the expected revenue from bidder $i$:
	\begin{align}
		\expe [Payment_i] &= \int_{\R_+} \expect{Payment_i|v_i} dF \\
		&= \int_{\R_+} F(v_i)^{n-1} s(v_i) f(v_i)\ dv_i
	\end{align}
	When $F = Unif(0, 1)$,
	\begin{align}
		\expe [Payment_i] &= \int_0^1 \frac{n-1}{n}v_i^n\ dv_i \\
		&= \frac{n-1}{n(n+1)}
	\end{align}
	
	\paragraph{Auctioneer's Expected Revenue} Since all bidders are the same,
	\begin{align}
		\expect{Revenue} &= n\ \expe [Payment_i] \\
		&= n\ \int_{\R_+} F(v_i)^{n-1} s(v_i) f_i\ dv_i
	\end{align}
	When $F = Unif(0, 1)$,
	\begin{align}
		\expect{Revenue} = \frac{n-1}{n+1}
	\end{align}
	
	\section{Second Price Private Value Auction}
	
	\section{The General Case: $k^{th}$ Price Private Value Auction}
	
	\section{Common Value Auction}
	
	\section{Combinatorial Auction: The VCG Mechanism}
	
	
	\section{Matching Market}

	\section{Appendix A: Order Statistics}
	\begin{definition}
		Let $(X_1, \cdots, X_n)$ be $n$ random variables on the probability space $(\Omega, \mc{F}, P)$, further assume they are iid following distribution function $F(\cdot)$. For each $\omega \in \Omega$, realizations of above random variables can be sorted as
		\begin{align}
			X_{(n)}(\omega) \leq X_{(n-1)}(\omega) \leq \cdots \leq X_{(1)}(\omega)
		\end{align}
		For each $\omega$, the random variable $X_{n:k}$ is defined such that $X_{n:k}(\omega)$ equals the $k$-th largest value, $X_{(k)}(\omega)$.
	\end{definition}
	
	\paragraph{Distribution Function} Let $x \in X(\Omega)$, then 
	\begin{align}
		X_{n:k} \leq x
		&\iff (\tx{no $X_i > x$}) \bigcup \left(\tx{exactly $1$ $X_i > x$}\right) \bigcup  \cdots \bigcup \left(\tx{exactly $k-1$ $X_i > x$}\right) \\
		&\iff (X_i \leq x\ \forall i) \bigcup \left(\tx{exactly $n-1$ $X_i \leq x$}\right) \bigcup  \cdots \bigcup \left(\tx{exactly $n-k+1$ $X_i \leq x$}\right) \\
		&\iff \bigcup_{j=n-k+1}^n \left(\tx{exactly $j$ $X_i \leq x$}\right)
	\end{align}
	Note that events in the union are mutually exclusive, therefore,
	\begin{align}
		F_{n:k}(x) = P(X_{n:k} \leq x)
		&= \sum_{j=n-k+1}^n P\left(\tx{exactly $j$ $X_i \leq x$}\right) \\
		&= \red{\sum_{j=n-k+1}^n \binom{n}{j} F(x)^j (1 - F(x))^{n-j}}
	\end{align}
	\paragraph{Density Function}
	\begin{align}
		f_{n:k}(x)
		&= \frac{d}{dx} F_{n:k}(x) \\
		&= \frac{d}{dx} \sum_{j=n-k+1}^n \binom{n}{j} F(x)^j (1 - F(x))^{n-j} \\
		&= \frac{d}{dx} \sum_{j=n-k+1}^n \frac{n!}{j!(n-j)!} F(x)^j (1 - F(x))^{n-j} \\
		&= \sum_{j=n-k+1}^n \left[
		\frac{n!}{j!(n-j)!} j F(x)^{j-1} (1 - F(x))^{n-j}
		- \frac{n!}{j!(n-j)!} (n-j) F(x)^j (1 - F(x))^{n-j-1}
		\right]f(x)\\
		&= \sum_{j=n-k+1}^n 
		\frac{n!}{j!(n-j)!} j F(x)^{j-1} (1 - F(x))^{n-j} f(x)
		- \sum_{j=n-k+1}^{n-1} 
		\frac{n!}{j!(n-j)!} (n-j) F(x)^j (1 - F(x))^{n-j-1} f(x)\\
		&= \sum_{j=n-k+1}^n
		\frac{n!}{(j-1)!(n-j)!} F(x)^{j-1} (1 - F(x))^{n-j} f(x)
		- \sum_{j=n-k+1}^{n-1}
		\frac{n!}{j!(n-j-1)!} F(x)^j (1 - F(x))^{n-j-1} f(x) \\
		&=\begin{aligned}[t]
			&\frac{n!}{(n-k)!(k-1)!} F(x)^{n-k} (1 - F(x))^{k-1} f(x) \\
			&+ \sum_{j=n-k+2}^n
			\frac{n!}{(j-1)!(n-j)!} F(x)^{j-1} (1 - F(x))^{n-j} f(x) \\
			&- \sum_{j=n-k+1}^{n-1}
			\frac{n!}{j!(n-j-1)!} F(x)^j (1 - F(x))^{n-j-1} f(x)
		\end{aligned} \\
		&=\begin{aligned}[t]
			&\frac{n!}{(n-k)!(k-1)!} F(x)^{n-k} (1 - F(x))^{k-1} f(x) \\
			&+ \sum_{j=n-k+2}^n
			\frac{n!}{(j-1)!(n-j)!} F(x)^{j-1} (1 - F(x))^{n-j} f(x) \\
			&- \sum_{i=n-k+2}^{n}
			\frac{n!}{(i-1)!(n-i)!} F(x)^{i-1} (1 - F(x))^{n-i} f(x) \text{ (substitute $j = i - 1$)}
		\end{aligned} \\
		&= \frac{n!}{(n-k)!(k-1)!} F(x)^{n-k} (1 - F(x))^{k-1} f(x) \\
		&= n \frac{(n-1)!}{(n-k)!(k-1)!} F(x)^{n-k} (1 - F(x))^{k-1} f(x) \\
		&= \red{
		n \binom{n-1}{k-1} F(x)^{n-k} (1 - F(x))^{k-1} f(x)
		}
	\end{align}
\end{document}























